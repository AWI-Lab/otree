language: python
python: 3.5
install:
  - pip install -r requirements.txt
before_script:
  - psql -c 'create database travis_ci_test;' -U postgres
script:
  - ls
  - otree test
env:
  - DATABASE_URL=postgres://postgres@localhost/travis_ci_test
after_success:
  - >
    [ "$TRAVIS_BRANCH" == "master" ]
    && curl -X POST -H "Content-Type: application/json"
    --data '{"docker_tag_name": "latest"}'
    https://registry.hub.docker.com/u/awilab/otree/trigger/$DOCKER_HUB_TOKEN/
